<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.buaa.markpp.dao.AnnotationDao">
    <insert id="insert" parameterType="Annotation" keyProperty="annotationId">
        insert into annotation(block_id, annotator_id, time, content<if test="replyToId > 0">,  reply_to_id </if>)
        values (#{blockId}, #{annotatorId}, now(), #{content}<if test="replyToId > 0">,  #{replyToId}</if>);
    </insert>
    <select id="select" parameterType="int" resultType="Annotation">
        select * from annotation where annotation_id = #{annotationId};
    </select>
    <select id="selectByBlockId" parameterType="int" resultType="Annotation">
        select * from annotation where block_id = #{blockId};
    </select>
    <update id="replaceBlockId" parameterType="int">
        update annotation set block_id = #{newId} where block_id = #{originalId}
    </update>
</mapper>